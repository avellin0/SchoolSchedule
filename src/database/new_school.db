CREATE TABLE usuario(
    userId UUID PRIMARY KEY NOT NULL,
    name VARCHAR(100) NOT NULL, 
    email VARCHAR(100) NOT NULL,
    password VARCHAR(64) NOT NULL,
    create_at DATE DEFAULT CURRENT_DATE,
    permission VARCHAR(20) NOT NULL
);

CREATE TABLE user_friends(
    user_id UUID REFERENCES usuario(userId) ON DELETE CASCADE,
    friend_id UUID REFERENCES usuario(userId) ON DELETE CASCADE,
    status VARCHAR(20) DEFAULT 'pending',
    created_at TIMESTAMP DEFAULT NOW(),
    PRIMARY KEY (user_id, friend_id)
);

CREATE TABLE books (
    book_id UUID PRIMARY KEY NOT NULL, 
    title VARCHAR(50) NOT NULL,
    author VARCHAR(50)
);


CREATE TABLE user_books (
    user_id UUID REFERENCES usuario(userId) ON DELETE CASCADE,
    book_id UUID REFERENCES books(book_Id) ON DELETE CASCADE,
    PRIMARY KEY (user_id, book_Id)
);

CREATE TABLE notes (
    note_id UUID PRIMARY KEY NOT NULL,
    user_id UUID REFERENCES usuario(userId) ON DELETE CASCADE,
    book_id UUID REFERENCES books(book_id) ON DELETE CASCADE,
    content TEXT,
    title TEXT,
    date TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE favorite_books (
    id SERIAL PRIMARY KEY,
    user_id UUID REFERENCES usuario(userId) ON DELETE CASCADE,
    book_id UUID REFERENCES books(book_id) ON DELETE CASCADE,
    favorited_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE (user_id, book_id)
)